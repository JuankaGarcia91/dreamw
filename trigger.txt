CREATE TABLE auditoria_persona
(
	cedula int (15) not null,
    fecha date,
    asunto_anterior varchar(100),
    asunto_nuevo varchar(100),
    primer_nombre_anterior varchar(20),
    primer_nombre_nuevo varchar(20),
    segundo_nombre_anterior varchar(20),
    segundo_nombre_nuevo varchar(20),
    primer_apellido_anterior varchar(20),
    primer_apellido_nuevo varchar(20),
    segundo_apellido_anterior varchar(20),
    segundo_apellido_nuevo varchar(20),
    fijo_anterior int(20),
    fijo_nuevo int(20),
    celular_anterior int(20),
    celular_nuevo int(20),
    direccion_anterior int(20),
    direccion_nuevo int(20),
    barrio_anterior int(20),
    barrio_nuevo int(20),
    pais_anterior int(20),
    pais_nuevo int(20),
    estado_anterior int(20),
    estado_nuevo int(20),
    ciudad_anterior int(20),
    ciudad_nuevo int(20),
    usuario varchar(20),
    modificado datetime,
    proceso varchar(20),
    primary key(cedula)
)

CREATE TRIGGER insertar_auditoria_persona AFTER INSERT ON persona
FOR EACH ROW
INSERT INTO auditoria_persona(
    primer_nombre_nuevo,
    segundo_nombre_nuevo,
    primer_apellido_nuevo,
    segundo_apellido_nuevo,
    fijo_nuevo,
    celular_nuevo,
    direccion_nuevo,
    barrio_nuevo,
    pais_nuevo,
    estado_nuevo,
    ciudad_nuevo,
    usuario, 
    modificado, 
    proceso)
VALUES (NEW.primer_nombre, 
        NEW.segundo_nombre,
    	NEW.primer_apellido,
    	NEW.segundo_apellido,
    	NEW.fijo,
    	NEW.celular,
    	NEW.direccion,
    	NEW.barrio,
    	NEW.pais,
    	NEW.estado,
    	NEW.ciudad,
    	CURRENT_USER(), 
        NOW(), 
        NEW.proceso);


CREATE TRIGGER Modifica_auditoria_persona BEFORE UPDATE ON persona
FOR EACH ROW
INSERT INTO auditoria_persona(
    primer_nombre_anterior,
    primer_nombre_nuevo,
    segundo_nombre_anterior,
    segundo_nombre_nuevo,
    primer_apellido_anterior,
    primer_apellido_nuevo,
    segundo_apellido_anterior,
    segundo_apellido_nuevo,
    fijo_anterior,
    fijo_nuevo,
    celular_anterior,
    celular_nuevo,
    direccion_anterior,
    direccion_nuevo,
    barrio_anterior,
    barrio_nuevo,
    pais_anterior,
    pais_nuevo,
    estado_anterior,
    estado_nuevo,
    ciudad_anterior,
    ciudad_nuevo,
    usuario,
    modificado,
    proceso)
VALUES (
    OLD.primer_nombre,
    NEW.primer_nombre,
    OLD.segundo_nombre,
    NEW.segundo_nombre,
    OLD.primer_apellido,
    NEW.primer_apellido,
    OLD.segundo_apellido,
    NEW.segundo_apellido,
    OLD.fijo,
    NEW.fijo,
    OLD.celular,
    NEW.celular,
    OLD.direccion,
    NEW.direccion,
    OLD.barrio,
    NEW.barrio,
    OLD.pais,
    NEW.pais,
    OLD.estado,
    NEW.estado,
    OLD.ciudad,
    NEW.ciudad,    
    CURRENT_USER(), 
    NOW(), 
    NEW.proceso);
